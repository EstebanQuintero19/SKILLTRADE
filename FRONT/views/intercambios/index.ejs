
<div class="container py-4">
  <!-- Sidebar -->
  <aside id="sidebar" class="p-3 text-center mb-4">
    <img src="/images/logo_skill.png" alt="Logo SkillTrade" width="80">
    <h2 class="mt-2 fw-bold text-white">SkillTrade</h2>
  </aside>

  <h2 class="mb-4 text-white">Propuestas de Intercambio</h2>

  <table class="table table-striped table-dark">
    <thead>
      <tr>
        <th>ID</th>
        <th>Usuario 1</th>
        <th>Usuario 2</th>
        <th>Curso Solicitado</th>
        <th>Curso Ofrecido</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody id="tablaIntercambios">
      <% if (exchanges && exchanges.length > 0) { %>
        <% exchanges.forEach((exchange, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= exchange.usuario1?.nombre || 'Usuario 1' %></td>
            <td><%= exchange.usuario2?.nombre || 'Usuario 2' %></td>
            <td><%= exchange.cursoSolicitado?.titulo || 'Curso solicitado' %></td>
            <td><%= exchange.cursoOfrecido?.titulo || 'Curso ofrecido' %></td>
            <td>
              <span class="badge bg-<%= exchange.estado === 'pendiente' ? 'warning' : exchange.estado === 'aceptado' ? 'success' : 'secondary' %> text-dark">
                <%= exchange.estado || 'Pendiente' %>
              </span>
            </td>
            <td class="btn-group">
              <button class="btn btn-sm btn-light ver" title="Ver" onclick="verIntercambio('<%= exchange._id %>')">
                <i class="fas fa-eye"></i>
              </button>
              <button class="btn btn-sm btn-light editar" title="Editar" onclick="editarIntercambio('<%= exchange._id %>')">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-sm btn-light eliminar" title="Eliminar" onclick="eliminarIntercambio('<%= exchange._id %>')">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="7" class="text-center text-muted">No hay intercambios disponibles</td>
        </tr>
      <% } %>
    </tbody>
  </table>
  
  <div>
    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalCrear">Crear Propuesta</button>
    <a href="/mis-cursos" class="btn btn-outline-secondary mt-3">← Volver a Mis Cursos</a>
  </div>
</div>

<!-- Modal CREAR PROPUESTA -->
<div class="modal fade" id="modalCrear" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Crear Propuesta de Intercambio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="formCrear">
          <div class="mb-2">
            <label for="crearUser1">Usuario 1</label>
            <input class="form-control" id="crearUser1" required>
          </div>
          <div class="mb-2">
            <label for="crearUser2">Usuario 2</label>
            <input class="form-control" id="crearUser2" required>
          </div>
          <div class="mb-2">
            <label for="crearCursoSolicitado">Curso Solicitado</label>
            <input class="form-control" id="crearCursoSolicitado" required>
          </div>
          <div class="mb-2">
            <label for="crearCursoOfrecido">Curso Ofrecido</label>
            <input class="form-control" id="crearCursoOfrecido" required>
          </div>
          <div class="mb-2">
            <label for="crearEstado">Estado</label>
            <select class="form-select" id="crearEstado" required>
              <option>Pendiente</option>
              <option>Aceptado</option>
              <option>Rechazado</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary mt-2">Agregar</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal VER -->
<div class="modal fade" id="modalVer" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Detalles del Intercambio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="infoVer">
        <!-- contenido generado con JS -->
      </div>
    </div>
  </div>
</div>

<!-- Modal EDITAR -->
<div class="modal fade" id="modalEditar" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar Intercambio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="formEditar">
          <input type="hidden" id="editId">
          <div class="mb-2">
            <label for="editUser1">Usuario 1</label>
            <input class="form-control" id="editUser1">
          </div>
          <div class="mb-2">
            <label for="editUser2">Usuario 2</label>
            <input class="form-control" id="editUser2">
          </div>
          <div class="mb-2">
            <label for="editCursoSolicitado">Curso Solicitado</label>
            <input class="form-control" id="editCursoSolicitado">
          </div>
          <div class="mb-2">
            <label for="editCursoOfrecido">Curso Ofrecido</label>
            <input class="form-control" id="editCursoOfrecido">
          </div>
          <div class="mb-2">
            <label for="editEstado">Estado</label>
            <select class="form-select" id="editEstado">
              <option>Pendiente</option>
              <option>Aceptado</option>
              <option>Rechazado</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary mt-2">Cambiar</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal ELIMINAR -->
<div class="modal fade" id="modalEliminar" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirmar Eliminación</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p>¿Seguro que quieres eliminar esta propuesta de intercambio?</p>
        <div class="d-flex justify-content-end gap-2">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn btn-danger" id="confirmarEliminar">Eliminar</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Funciones para manejar los intercambios
function verIntercambio(id) {
  // Implementar lógica para ver intercambio
  console.log('Ver intercambio:', id);
}

function editarIntercambio(id) {
  // Implementar lógica para editar intercambio
  console.log('Editar intercambio:', id);
}

function eliminarIntercambio(id) {
  // Implementar lógica para eliminar intercambio
  console.log('Eliminar intercambio:', id);
}
</script>
